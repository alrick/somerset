'use strict';var CC=contentful.createClient({space:'uemu4ddo7lar',accessToken:'c04219e0ca55fb73faabf90ec9d6ba90f5e2fa60e9e33a6eacf2f6228cceed38'});
'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value'in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called')}return call&&(typeof call==='object'||typeof call==='function')?call:self}function _inherits(subClass,superClass){if(typeof superClass!=='function'&&superClass!==null){throw new TypeError('Super expression must either be null or a function, not '+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var Pin=function(){function Pin(name,description,latlng,ratio){_classCallCheck(this,Pin);this.name=name;this.description=description;this.latlng=latlng;this.ratio=ratio;this.width=55;this.height=55;this.icon='icons/ghost.png'}_createClass(Pin,[{key:'toString',value:function toString(){var description=this.description===''?'':'<br>'+this.description;return'<span class="title">'+this.name+'</span><br>'+this._getType()+description}},{key:'getMarker',value:function getMarker(){var marker=L.marker(this.latlng,{icon:this._buildIcon()});var tooltip=L.tooltip({direction:'bottom',className:'calligraffitti tooltip'});marker.bindTooltip(tooltip).setTooltipContent(this.toString());return marker}},{key:'_getType',value:function _getType(){return''}},{key:'_buildIcon',value:function _buildIcon(){var width=this.width;var height=this.height;return L.divIcon({html:this._getHtml(this.icon,width,height),iconSize:[width*this.ratio,height*this.ratio],iconAnchor:[width*this.ratio/2,height*this.ratio],popupAnchor:[0,-(height*this.ratio)],className:'icon'})}},{key:'_getHtml',value:function _getHtml(icon,width,height){var i='<img src="'+icon+'" width="'+width*this.ratio+'" height="'+height*this.ratio+'">';var blason=this._hasOwner()?'<img src="blasons/'+this.owner.toLowerCase()+'.png" width="'+30*this.ratio+'" style="position:absolute;top:2px;right:'+-21*this.ratio+'px;">':'';var vassal=this._isVassal()?'<img src="blasons/vassal.png" width="'+19*this.ratio+'" style="position:absolute;top:6px;right:'+-40*this.ratio+'px;">':'';return i+blason+vassal}},{key:'_hasOwner',value:function _hasOwner(){return this.hasOwnProperty('owner')&&this.owner!==undefined&&this.owner!==''}},{key:'_isVassal',value:function _isVassal(){return this.hasOwnProperty('isVassal')&&this.isVassal===true}}]);return Pin}();var Chateau=function(_Pin){_inherits(Chateau,_Pin);function Chateau(name,description,latlng,ratio){_classCallCheck(this,Chateau);var _this=_possibleConstructorReturn(this,(Chateau.__proto__||Object.getPrototypeOf(Chateau)).call(this,name,description,latlng,ratio));_this.width=80;_this.height=98;_this.icon='icons/chateau.png';return _this}_createClass(Chateau,[{key:'_getType',value:function _getType(){return'Ch\xE2teau'}}]);return Chateau}(Pin);var Magic=function(_Pin2){_inherits(Magic,_Pin2);function Magic(name,description,latlng,ratio){_classCallCheck(this,Magic);var _this2=_possibleConstructorReturn(this,(Magic.__proto__||Object.getPrototypeOf(Magic)).call(this,name,description,latlng,ratio));_this2.width=47;_this2.height=64;_this2.icon='icons/magic.png';return _this2}_createClass(Magic,[{key:'_getType',value:function _getType(){return'Endroit magique'}}]);return Magic}(Pin);var Abbaye=function(_Pin3){_inherits(Abbaye,_Pin3);function Abbaye(name,description,latlng,ratio){_classCallCheck(this,Abbaye);var _this3=_possibleConstructorReturn(this,(Abbaye.__proto__||Object.getPrototypeOf(Abbaye)).call(this,name,description,latlng,ratio));_this3.width=73;_this3.height=70;_this3.icon='icons/abbaye.png';return _this3}_createClass(Abbaye,[{key:'_getType',value:function _getType(){return'Abbaye'}}]);return Abbaye}(Pin);
'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value'in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _get=function get(object,property,receiver){if(object===null)object=Function.prototype;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc===undefined){var parent=Object.getPrototypeOf(object);if(parent===null){return undefined}else{return get(parent,property,receiver)}}else if('value'in desc){return desc.value}else{var getter=desc.get;if(getter===undefined){return undefined}return getter.call(receiver)}};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called')}return call&&(typeof call==='object'||typeof call==='function')?call:self}function _inherits(subClass,superClass){if(typeof superClass!=='function'&&superClass!==null){throw new TypeError('Super expression must either be null or a function, not '+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var Fief=function(_Pin){_inherits(Fief,_Pin);function Fief(name,description,latlng,ratio,pop,owner,isVassal){_classCallCheck(this,Fief);var _this=_possibleConstructorReturn(this,(Fief.__proto__||Object.getPrototypeOf(Fief)).call(this,name,description,latlng,ratio));_this.pop=pop;_this.owner=owner;_this.isVassal=isVassal;return _this}_createClass(Fief,[{key:'toString',value:function toString(){return _get(Fief.prototype.__proto__||Object.getPrototypeOf(Fief.prototype),'toString',this).call(this)+'<br>'+this.soldats+' soldats, '+this.garnison+' garnison, '+this.chevaliers+' chevaliers'}},{key:'_getType',value:function _getType(){return this._getTypeName()+'('+this.pop+')'}}]);return Fief}(Pin);var VillageFief=function(_Fief){_inherits(VillageFief,_Fief);function VillageFief(name,description,latlng,ratio,pop,owner,isVassal){_classCallCheck(this,VillageFief);var _this2=_possibleConstructorReturn(this,(VillageFief.__proto__||Object.getPrototypeOf(VillageFief)).call(this,name,description,latlng,ratio,pop,owner,isVassal));_this2.icon='icons/village.png';_this2.width=47;_this2.height=55;_this2.chevaliers=0;return _this2}return VillageFief}(Fief);var BourgFief=function(_Fief2){_inherits(BourgFief,_Fief2);function BourgFief(name,description,latlng,ratio,pop,owner,isVassal){_classCallCheck(this,BourgFief);var _this3=_possibleConstructorReturn(this,(BourgFief.__proto__||Object.getPrototypeOf(BourgFief)).call(this,name,description,latlng,ratio,pop,owner,isVassal));_this3.icon='icons/bourg.png';_this3.width=87;_this3.height=60;return _this3}return BourgFief}(Fief);var VilleFief=function(_Fief3){_inherits(VilleFief,_Fief3);function VilleFief(name,description,latlng,ratio,pop,owner,isVassal){_classCallCheck(this,VilleFief);var _this4=_possibleConstructorReturn(this,(VilleFief.__proto__||Object.getPrototypeOf(VilleFief)).call(this,name,description,latlng,ratio,pop,owner,isVassal));_this4.icon='icons/ville.png';_this4.width=149;_this4.height=70;return _this4}return VilleFief}(Fief);var Hameau=function(_VillageFief){_inherits(Hameau,_VillageFief);function Hameau(name,description,latlng,ratio,pop,owner,isVassal){_classCallCheck(this,Hameau);var _this5=_possibleConstructorReturn(this,(Hameau.__proto__||Object.getPrototypeOf(Hameau)).call(this,name,description,latlng,ratio,pop,owner,isVassal));_this5.soldats=0;_this5.garnison=2;return _this5}_createClass(Hameau,[{key:'_getTypeName',value:function _getTypeName(){return'Hameau'}}]);return Hameau}(VillageFief);var PetitVillage=function(_VillageFief2){_inherits(PetitVillage,_VillageFief2);function PetitVillage(name,description,latlng,ratio,pop,owner,isVassal){_classCallCheck(this,PetitVillage);var _this6=_possibleConstructorReturn(this,(PetitVillage.__proto__||Object.getPrototypeOf(PetitVillage)).call(this,name,description,latlng,ratio,pop,owner,isVassal));_this6.soldats=2;_this6.garnison=5;return _this6}_createClass(PetitVillage,[{key:'_getTypeName',value:function _getTypeName(){return'Petit Village'}}]);return PetitVillage}(VillageFief);var Village=function(_VillageFief3){_inherits(Village,_VillageFief3);function Village(name,description,latlng,ratio,pop,owner,isVassal){_classCallCheck(this,Village);var _this7=_possibleConstructorReturn(this,(Village.__proto__||Object.getPrototypeOf(Village)).call(this,name,description,latlng,ratio,pop,owner,isVassal));_this7.soldats=3;_this7.garnison=5;return _this7}_createClass(Village,[{key:'_getTypeName',value:function _getTypeName(){return'Village'}}]);return Village}(VillageFief);var PetiteBourgade=function(_VillageFief4){_inherits(PetiteBourgade,_VillageFief4);function PetiteBourgade(name,description,latlng,ratio,pop,owner,isVassal){_classCallCheck(this,PetiteBourgade);var _this8=_possibleConstructorReturn(this,(PetiteBourgade.__proto__||Object.getPrototypeOf(PetiteBourgade)).call(this,name,description,latlng,ratio,pop,owner,isVassal));_this8.soldats=5;_this8.garnison=10;return _this8}_createClass(PetiteBourgade,[{key:'_getTypeName',value:function _getTypeName(){return'Petite Bourgade'}}]);return PetiteBourgade}(VillageFief);var Bourgade=function(_VillageFief5){_inherits(Bourgade,_VillageFief5);function Bourgade(name,description,latlng,ratio,pop,owner,isVassal){_classCallCheck(this,Bourgade);var _this9=_possibleConstructorReturn(this,(Bourgade.__proto__||Object.getPrototypeOf(Bourgade)).call(this,name,description,latlng,ratio,pop,owner,isVassal));_this9.soldats=5;_this9.garnison=10;_this9.chevaliers=1;return _this9}_createClass(Bourgade,[{key:'_getTypeName',value:function _getTypeName(){return'Bourgade'}}]);return Bourgade}(VillageFief);var PetitBourg=function(_BourgFief){_inherits(PetitBourg,_BourgFief);function PetitBourg(name,description,latlng,ratio,pop,owner,isVassal){_classCallCheck(this,PetitBourg);var _this10=_possibleConstructorReturn(this,(PetitBourg.__proto__||Object.getPrototypeOf(PetitBourg)).call(this,name,description,latlng,ratio,pop,owner,isVassal));_this10.soldats=15;_this10.garnison=20;_this10.chevaliers=2;return _this10}_createClass(PetitBourg,[{key:'_getTypeName',value:function _getTypeName(){return'Petit Bourg'}}]);return PetitBourg}(BourgFief);var Bourg=function(_BourgFief2){_inherits(Bourg,_BourgFief2);function Bourg(name,description,latlng,ratio,pop,owner,isVassal){_classCallCheck(this,Bourg);var _this11=_possibleConstructorReturn(this,(Bourg.__proto__||Object.getPrototypeOf(Bourg)).call(this,name,description,latlng,ratio,pop,owner,isVassal));_this11.soldats=25;_this11.garnison=40;_this11.chevaliers=4;return _this11}_createClass(Bourg,[{key:'_getTypeName',value:function _getTypeName(){return'Bourg'}}]);return Bourg}(BourgFief);var GrandBourg=function(_BourgFief3){_inherits(GrandBourg,_BourgFief3);function GrandBourg(name,description,latlng,ratio,pop,owner,isVassal){_classCallCheck(this,GrandBourg);var _this12=_possibleConstructorReturn(this,(GrandBourg.__proto__||Object.getPrototypeOf(GrandBourg)).call(this,name,description,latlng,ratio,pop,owner,isVassal));_this12.soldats=35;_this12.garnison=80;_this12.chevaliers=6;return _this12}_createClass(GrandBourg,[{key:'_getTypeName',value:function _getTypeName(){return'Grand Bourg'}}]);return GrandBourg}(BourgFief);var Ville=function(_VilleFief){_inherits(Ville,_VilleFief);function Ville(name,description,latlng,ratio,pop,owner,isVassal){_classCallCheck(this,Ville);var _this13=_possibleConstructorReturn(this,(Ville.__proto__||Object.getPrototypeOf(Ville)).call(this,name,description,latlng,ratio,pop,owner,isVassal));_this13.soldats=50;_this13.garnison=120;_this13.chevaliers=9;return _this13}_createClass(Ville,[{key:'_getTypeName',value:function _getTypeName(){return'Ville'}}]);return Ville}(VilleFief);var GrandeVille=function(_VilleFief2){_inherits(GrandeVille,_VilleFief2);function GrandeVille(name,description,latlng,ratio,pop,owner,isVassal){_classCallCheck(this,GrandeVille);var _this14=_possibleConstructorReturn(this,(GrandeVille.__proto__||Object.getPrototypeOf(GrandeVille)).call(this,name,description,latlng,ratio,pop,owner,isVassal));_this14.soldats=65;_this14.garnison=160;_this14.chevaliers=12;return _this14}_createClass(GrandeVille,[{key:'_getTypeName',value:function _getTypeName(){return'Grande Ville'}}]);return GrandeVille}(VilleFief);
'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value'in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called')}return call&&(typeof call==='object'||typeof call==='function')?call:self}function _inherits(subClass,superClass){if(typeof superClass!=='function'&&superClass!==null){throw new TypeError('Super expression must either be null or a function, not '+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var Defense=function(_Pin){_inherits(Defense,_Pin);function Defense(name,description,latlng,ratio,owner){_classCallCheck(this,Defense);var _this=_possibleConstructorReturn(this,(Defense.__proto__||Object.getPrototypeOf(Defense)).call(this,name,description,latlng,ratio));_this.owner=owner;return _this}return Defense}(Pin);var TourBois=function(_Defense){_inherits(TourBois,_Defense);function TourBois(name,description,latlng,ratio,owner){_classCallCheck(this,TourBois);var _this2=_possibleConstructorReturn(this,(TourBois.__proto__||Object.getPrototypeOf(TourBois)).call(this,name,description,latlng,ratio,owner));_this2.width=30;_this2.height=89;_this2.icon='icons/tourBois.png';return _this2}_createClass(TourBois,[{key:'_getType',value:function _getType(){return'Tour en Bois'}}]);return TourBois}(Defense);var TourPierre=function(_Defense2){_inherits(TourPierre,_Defense2);function TourPierre(name,description,latlng,ratio,owner){_classCallCheck(this,TourPierre);var _this3=_possibleConstructorReturn(this,(TourPierre.__proto__||Object.getPrototypeOf(TourPierre)).call(this,name,description,latlng,ratio,owner));_this3.width=30;_this3.height=90;_this3.icon='icons/tourPierre.png';return _this3}_createClass(TourPierre,[{key:'_getType',value:function _getType(){return'Tour en Pierre'}}]);return TourPierre}(Defense);
'use strict';function buildPin(data,ratio){var name=data.name;var description=data.description!==undefined?data.description:'';var latlng=[data.lat,data.lng];var type=data.type;var owner=data.owner!==undefined?data.owner.fields.name:'';var vassal=data.vassal;switch(type){case 1:return new Hameau(name,description,latlng,ratio,type,owner,vassal);case 2:return new PetitVillage(name,description,latlng,ratio,type,owner,vassal);case 3:return new Village(name,description,latlng,ratio,type,owner,vassal);case 4:return new PetiteBourgade(name,description,latlng,ratio,type,owner,vassal);case 5:return new Bourgade(name,description,latlng,ratio,type,owner,vassal);case 6:case 7:return new PetitBourg(name,description,latlng,ratio,type,owner,vassal);case 8:case 9:return new Bourg(name,description,latlng,ratio,type,owner,vassal);case 10:case 11:return new GrandBourg(name,description,latlng,ratio,type,owner,vassal);case 12:case 13:return new Ville(name,description,latlng,ratio,type,owner,vassal);case 14:case 15:case 16:case 17:return new GrandeVille(name,description,latlng,ratio,type,owner,vassal);case'woodTower':return new TourBois(name,description,latlng,ratio,owner);case'stoneTower':return new TourPierre(name,description,latlng,ratio,owner);case'castle':return new Chateau(name,description,latlng,ratio);case'magic':return new Magic(name,description,latlng,ratio);case'abbey':return new Abbaye(name,description,latlng,ratio);default:return new Pin(name,description,latlng,ratio);}}
'use strict';// vars
var map=void 0;var zoom6=L.layerGroup();var zoom7=L.layerGroup();var ratio7=1;var ratio6=0.65;var allowedContentType=['building','defense','fief'];// init map
$('#map').height(window.innerHeight-20);map=L.map('map',{minZoom:6,maxZoom:7}).setView([18.15629,34.67285],6);// set background
CC.getAsset('5IedQC7r2geCO2UOAoug2A').then(function(asset){L.imageOverlay('https:'+asset.fields.file.url,[[0,0],[42.28,55]]).addTo(map)});// map events
map.on('contextmenu',function(ev){window.prompt('Copy to clipboard: Ctrl+C, Enter',ev.latlng.lat.toFixed(3)+','+ev.latlng.lng.toFixed(3))});map.on('zoomstart',function(){map.removeLayer(zoom6);map.removeLayer(zoom7)});map.on('zoomend',function(){var zoom=map.getZoom();map.removeLayer(zoom6);map.removeLayer(zoom7);map.addLayer(window['zoom'+zoom])});CC.getEntries().then(function(entries){// log the title for all the entries that have it
entries.items.forEach(function(entry){if(allowedContentType.indexOf(entry.sys.contentType.sys.id)>-1){var data=entry.fields;var pin7=buildPin(data,ratio7);var pin6=buildPin(data,ratio6);zoom7.addLayer(pin7.getMarker());zoom6.addLayer(pin6.getMarker())}});map.addLayer(zoom6)});
