'use strict';var datas=new Set;datas.add({owner:'other',code:'cc73111d-d8d7-11e6-b16a-89aa9fe53353'});datas.add({owner:'deoord',code:'e74f3eb7-d8d6-11e6-b16a-3f7d8b2f5214'});datas.add({owner:'odo',code:'2ea9e28a-d8e3-11e6-b16a-1bb5d129a9b5'});datas.add({owner:'lothar',code:'0d2ad688-d8ff-11e6-b16a-e75545913121'});datas.add({owner:'valens',code:'7bff4c78-da4b-11e6-90ab-4bf3db7cce9c'});datas.add({owner:'tulkas',code:'5c93f771-da62-11e6-90ab-21f84d30b753'});datas.add({owner:'aeron',code:'14d09764-da67-11e6-90ab-b1eb1806377e'});
'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value'in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called')}return call&&(typeof call==='object'||typeof call==='function')?call:self}function _inherits(subClass,superClass){if(typeof superClass!=='function'&&superClass!==null){throw new TypeError('Super expression must either be null or a function, not '+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var Pin=function(){function Pin(name,description,latlng,ratio){_classCallCheck(this,Pin);this.name=name;this.description=description;this.latlng=latlng;this.width=55;this.height=55;this.ratio=ratio;this.icon='icons/ghost.png'}_createClass(Pin,[{key:'toString',value:function toString(){var description=this.description==''?'':'<br>'+this.description;return'<span class="title">'+this.name+'</span><br>'+this._getType()+description}},{key:'getMarker',value:function getMarker(){var marker=L.marker(this.latlng,{icon:this._buildIcon()});var tooltip=L.tooltip({direction:'bottom',className:'calligraffitti tooltip'});marker.bindTooltip(tooltip).setTooltipContent(this.toString());return marker}},{key:'_buildIcon',value:function _buildIcon(){return L.divIcon({html:this._getHtml(),iconSize:[this.width*this.ratio,this.height*this.ratio],iconAnchor:[this.width*this.ratio/2,this.height*this.ratio],popupAnchor:[0,-(this.height*this.ratio)],className:'icon'})}},{key:'_getHtml',value:function _getHtml(){var icon='<img src="'+this.icon+'" width="'+this.width*this.ratio+'" height="'+this.height*this.ratio+'">';var blason=this._hasOwner()?'<img src="blasons/'+this.owner+'.png" width="'+30*this.ratio+'" class="blason" style="position:absolute;top:0;right:'+-13*this.ratio+'px;">':'';return icon+blason}},{key:'_hasOwner',value:function _hasOwner(){return this.hasOwnProperty('owner')&&this.owner!='other'}}]);return Pin}();// 
// Pin
var Chateau=function(_Pin){_inherits(Chateau,_Pin);function Chateau(name,description,latlng,ratio){_classCallCheck(this,Chateau);var _this=_possibleConstructorReturn(this,(Chateau.__proto__||Object.getPrototypeOf(Chateau)).call(this,name,description,latlng,ratio));_this.width=60;_this.height=57;_this.icon='icons/chateau.png';return _this}_createClass(Chateau,[{key:'_getType',value:function _getType(){return'Ch\xE2teau'}}]);return Chateau}(Pin);var Magic=function(_Pin2){_inherits(Magic,_Pin2);function Magic(name,description,latlng,ratio){_classCallCheck(this,Magic);var _this2=_possibleConstructorReturn(this,(Magic.__proto__||Object.getPrototypeOf(Magic)).call(this,name,description,latlng,ratio));_this2.width=40;_this2.height=53;_this2.icon='icons/compotier.png';return _this2}_createClass(Magic,[{key:'_getType',value:function _getType(){return'Endroit magique'}}]);return Magic}(Pin);var Abbaye=function(_Pin3){_inherits(Abbaye,_Pin3);function Abbaye(name,description,latlng,ratio){_classCallCheck(this,Abbaye);var _this3=_possibleConstructorReturn(this,(Abbaye.__proto__||Object.getPrototypeOf(Abbaye)).call(this,name,description,latlng,ratio));_this3.width=50;_this3.height=48;_this3.icon='icons/abbaye.png';return _this3}_createClass(Abbaye,[{key:'_getType',value:function _getType(){return'Abbaye'}}]);return Abbaye}(Pin);
'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value'in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _get=function get(object,property,receiver){if(object===null)object=Function.prototype;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc===undefined){var parent=Object.getPrototypeOf(object);if(parent===null){return undefined}else{return get(parent,property,receiver)}}else if('value'in desc){return desc.value}else{var getter=desc.get;if(getter===undefined){return undefined}return getter.call(receiver)}};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called')}return call&&(typeof call==='object'||typeof call==='function')?call:self}function _inherits(subClass,superClass){if(typeof superClass!=='function'&&superClass!==null){throw new TypeError('Super expression must either be null or a function, not '+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}// 
// Pin
var Fief=function(_Pin){_inherits(Fief,_Pin);function Fief(name,description,latlng,ratio,pop,owner,isVassal){_classCallCheck(this,Fief);var _this=_possibleConstructorReturn(this,(Fief.__proto__||Object.getPrototypeOf(Fief)).call(this,name,description,latlng,ratio));_this.pop=pop;_this.owner=owner;_this.isVassal=isVassal;return _this}_createClass(Fief,[{key:'toString',value:function toString(){return _get(Fief.prototype.__proto__||Object.getPrototypeOf(Fief.prototype),'toString',this).call(this)+'<br>'+this.soldats+' soldats, '+this.garnison+' garnison, '+this.chevaliers+' chevaliers'}},{key:'_getType',value:function _getType(){return this._getTypeName()+'('+this.pop+')'}}]);return Fief}(Pin);// 
// Fief
var VillageFief=function(_Fief){_inherits(VillageFief,_Fief);function VillageFief(name,description,latlng,ratio,pop,owner,isVassal){_classCallCheck(this,VillageFief);var _this2=_possibleConstructorReturn(this,(VillageFief.__proto__||Object.getPrototypeOf(VillageFief)).call(this,name,description,latlng,ratio,pop,owner,isVassal));if(isVassal){_this2.icon='icons/village_v.png'}else{_this2.icon='icons/village.png'}_this2.width=40;_this2.height=49;_this2.chevaliers=0;return _this2}return VillageFief}(Fief);var BourgFief=function(_Fief2){_inherits(BourgFief,_Fief2);function BourgFief(name,description,latlng,ratio,pop,owner,isVassal){_classCallCheck(this,BourgFief);var _this3=_possibleConstructorReturn(this,(BourgFief.__proto__||Object.getPrototypeOf(BourgFief)).call(this,name,description,latlng,ratio,pop,owner,isVassal));if(isVassal){_this3.icon='icons/bourg_v.png'}else{_this3.icon='icons/bourg.png'}_this3.width=65;_this3.height=54;return _this3}return BourgFief}(Fief);var VilleFief=function(_Fief3){_inherits(VilleFief,_Fief3);function VilleFief(name,description,latlng,ratio,pop,owner,isVassal){_classCallCheck(this,VilleFief);var _this4=_possibleConstructorReturn(this,(VilleFief.__proto__||Object.getPrototypeOf(VilleFief)).call(this,name,description,latlng,ratio,pop,owner,isVassal));if(isVassal){_this4.icon='icons/ville_v.png'}else{_this4.icon='icons/ville.png'}_this4.width=70;_this4.height=71;return _this4}return VilleFief}(Fief);// 
// VillageFief
var Hameau=function(_VillageFief){_inherits(Hameau,_VillageFief);function Hameau(name,description,latlng,ratio,pop,owner,isVassal){_classCallCheck(this,Hameau);var _this5=_possibleConstructorReturn(this,(Hameau.__proto__||Object.getPrototypeOf(Hameau)).call(this,name,description,latlng,ratio,pop,owner,isVassal));_this5.soldats=0;_this5.garnison=2;return _this5}_createClass(Hameau,[{key:'_getTypeName',value:function _getTypeName(){return'Hameau'}}]);return Hameau}(VillageFief);var PetitVillage=function(_VillageFief2){_inherits(PetitVillage,_VillageFief2);function PetitVillage(name,description,latlng,ratio,pop,owner,isVassal){_classCallCheck(this,PetitVillage);var _this6=_possibleConstructorReturn(this,(PetitVillage.__proto__||Object.getPrototypeOf(PetitVillage)).call(this,name,description,latlng,ratio,pop,owner,isVassal));_this6.soldats=2;_this6.garnison=5;return _this6}_createClass(PetitVillage,[{key:'_getTypeName',value:function _getTypeName(){return'Petit Village'}}]);return PetitVillage}(VillageFief);var Village=function(_VillageFief3){_inherits(Village,_VillageFief3);function Village(name,description,latlng,ratio,pop,owner,isVassal){_classCallCheck(this,Village);var _this7=_possibleConstructorReturn(this,(Village.__proto__||Object.getPrototypeOf(Village)).call(this,name,description,latlng,ratio,pop,owner,isVassal));_this7.soldats=3;_this7.garnison=5;return _this7}_createClass(Village,[{key:'_getTypeName',value:function _getTypeName(){return'Village'}}]);return Village}(VillageFief);var PetiteBourgade=function(_VillageFief4){_inherits(PetiteBourgade,_VillageFief4);function PetiteBourgade(name,description,latlng,ratio,pop,owner,isVassal){_classCallCheck(this,PetiteBourgade);var _this8=_possibleConstructorReturn(this,(PetiteBourgade.__proto__||Object.getPrototypeOf(PetiteBourgade)).call(this,name,description,latlng,ratio,pop,owner,isVassal));_this8.soldats=5;_this8.garnison=10;return _this8}_createClass(PetiteBourgade,[{key:'_getTypeName',value:function _getTypeName(){return'Petite Bourgade'}}]);return PetiteBourgade}(VillageFief);var Bourgade=function(_VillageFief5){_inherits(Bourgade,_VillageFief5);function Bourgade(name,description,latlng,ratio,pop,owner,isVassal){_classCallCheck(this,Bourgade);var _this9=_possibleConstructorReturn(this,(Bourgade.__proto__||Object.getPrototypeOf(Bourgade)).call(this,name,description,latlng,ratio,pop,owner,isVassal));_this9.soldats=5;_this9.garnison=10;_this9.chevaliers=1;return _this9}_createClass(Bourgade,[{key:'_getTypeName',value:function _getTypeName(){return'Bourgade'}}]);return Bourgade}(VillageFief);// 
// BourgFief
var PetitBourg=function(_BourgFief){_inherits(PetitBourg,_BourgFief);function PetitBourg(name,description,latlng,ratio,pop,owner,isVassal){_classCallCheck(this,PetitBourg);var _this10=_possibleConstructorReturn(this,(PetitBourg.__proto__||Object.getPrototypeOf(PetitBourg)).call(this,name,description,latlng,ratio,pop,owner,isVassal));_this10.soldats=15;_this10.garnison=20;_this10.chevaliers=2;return _this10}_createClass(PetitBourg,[{key:'_getTypeName',value:function _getTypeName(){return'Petit Bourg'}}]);return PetitBourg}(BourgFief);var Bourg=function(_BourgFief2){_inherits(Bourg,_BourgFief2);function Bourg(name,description,latlng,ratio,pop,owner,isVassal){_classCallCheck(this,Bourg);var _this11=_possibleConstructorReturn(this,(Bourg.__proto__||Object.getPrototypeOf(Bourg)).call(this,name,description,latlng,ratio,pop,owner,isVassal));_this11.soldats=25;_this11.garnison=40;_this11.chevaliers=4;return _this11}_createClass(Bourg,[{key:'_getTypeName',value:function _getTypeName(){return'Bourg'}}]);return Bourg}(BourgFief);var GrandBourg=function(_BourgFief3){_inherits(GrandBourg,_BourgFief3);function GrandBourg(name,description,latlng,ratio,pop,owner,isVassal){_classCallCheck(this,GrandBourg);var _this12=_possibleConstructorReturn(this,(GrandBourg.__proto__||Object.getPrototypeOf(GrandBourg)).call(this,name,description,latlng,ratio,pop,owner,isVassal));_this12.soldats=35;_this12.garnison=80;_this12.chevaliers=6;return _this12}_createClass(GrandBourg,[{key:'_getTypeName',value:function _getTypeName(){return'Grand Bourg'}}]);return GrandBourg}(BourgFief);// 
// VilleFief
var Ville=function(_VilleFief){_inherits(Ville,_VilleFief);function Ville(name,description,latlng,ratio,pop,owner,isVassal){_classCallCheck(this,Ville);var _this13=_possibleConstructorReturn(this,(Ville.__proto__||Object.getPrototypeOf(Ville)).call(this,name,description,latlng,ratio,pop,owner,isVassal));_this13.soldats=50;_this13.garnison=120;_this13.chevaliers=9;return _this13}_createClass(Ville,[{key:'_getTypeName',value:function _getTypeName(){return'Ville'}}]);return Ville}(VilleFief);var GrandeVille=function(_VilleFief2){_inherits(GrandeVille,_VilleFief2);function GrandeVille(name,description,latlng,ratio,pop,owner,isVassal){_classCallCheck(this,GrandeVille);var _this14=_possibleConstructorReturn(this,(GrandeVille.__proto__||Object.getPrototypeOf(GrandeVille)).call(this,name,description,latlng,ratio,pop,owner,isVassal));_this14.soldats=65;_this14.garnison=160;_this14.chevaliers=12;return _this14}_createClass(GrandeVille,[{key:'_getTypeName',value:function _getTypeName(){return'Grande Ville'}}]);return GrandeVille}(VilleFief);
'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value'in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called')}return call&&(typeof call==='object'||typeof call==='function')?call:self}function _inherits(subClass,superClass){if(typeof superClass!=='function'&&superClass!==null){throw new TypeError('Super expression must either be null or a function, not '+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}// 
// Pin
var Defense=function(_Pin){_inherits(Defense,_Pin);function Defense(name,description,latlng,ratio,owner){_classCallCheck(this,Defense);var _this=_possibleConstructorReturn(this,(Defense.__proto__||Object.getPrototypeOf(Defense)).call(this,name,description,latlng,ratio));_this.owner=owner;_this.height=57;return _this}return Defense}(Pin);// 
// Defense
var TourBois=function(_Defense){_inherits(TourBois,_Defense);function TourBois(name,description,latlng,ratio,owner){_classCallCheck(this,TourBois);var _this2=_possibleConstructorReturn(this,(TourBois.__proto__||Object.getPrototypeOf(TourBois)).call(this,name,description,latlng,ratio,owner));_this2.width=18;_this2.icon='icons/tourBois.png';return _this2}_createClass(TourBois,[{key:'_getType',value:function _getType(){return'Tour en Bois'}}]);return TourBois}(Defense);var TourPierre=function(_Defense2){_inherits(TourPierre,_Defense2);function TourPierre(name,description,latlng,ratio,owner){_classCallCheck(this,TourPierre);var _this3=_possibleConstructorReturn(this,(TourPierre.__proto__||Object.getPrototypeOf(TourPierre)).call(this,name,description,latlng,ratio,owner));_this3.width=36;_this3.icon='icons/tourPierre.png';return _this3}_createClass(TourPierre,[{key:'_getType',value:function _getType(){return'Tour en Pierre'}}]);return TourPierre}(Defense);
'use strict';function buildPin(type,name,description,latlng,ratio,owner){var isVassal=arguments.length>6&&arguments[6]!==undefined?arguments[6]:false;switch(type){case 1:return new Hameau(name,description,latlng,ratio,type,owner,isVassal);case 2:return new PetitVillage(name,description,latlng,ratio,type,owner,isVassal);case 3:return new Village(name,description,latlng,ratio,type,owner,isVassal);case 4:return new PetiteBourgade(name,description,latlng,ratio,type,owner,isVassal);case 5:return new Bourgade(name,description,latlng,ratio,type,owner,isVassal);case 6:case 7:return new PetitBourg(name,description,latlng,ratio,type,owner,isVassal);case 8:case 9:return new Bourg(name,description,latlng,ratio,type,owner,isVassal);case 10:case 11:return new GrandBourg(name,description,latlng,ratio,type,owner,isVassal);case 12:case 13:return new Ville(name,description,latlng,ratio,type,owner,isVassal);case 14:case 15:case 16:case 17:return new GrandeVille(name,description,latlng,ratio,type,owner,isVassal);case'tourBois':return new TourBois(name,description,latlng,ratio,owner);case'tourPierre':return new TourPierre(name,description,latlng,ratio,owner);case'chateau':return new Chateau(name,description,latlng,ratio);case'magic':return new Magic(name,description,latlng,ratio);case'abbaye':return new Abbaye(name,description,latlng,ratio);default:return new Pin(name,description,latlng,ratio);}}
'use strict';$('#map').height(window.innerHeight-20);// init map
var map=L.map('map',{minZoom:6,maxZoom:7}).setView([18.15629,34.67285],6);L.imageOverlay('somerset.png',[[0,0],[42.28,55]]).addTo(map);var group7=L.layerGroup();var group6=L.layerGroup();var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{var _loop=function _loop(){var d=_step.value;$.ajax({type:'GET',url:'https://jsonblob.com/api/jsonBlob/'+d.code,contentType:'application/json; charset=utf-8',dataType:'json',success:function success(json){var _iteratorNormalCompletion2=true;var _didIteratorError2=false;var _iteratorError2=undefined;try{for(var _iterator2=json[Symbol.iterator](),_step2;!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=true){var object=_step2.value;var pin7=buildPin(object.type,object.name,object.description,object.latlng,1,d.owner,object.v||false);var pin6=buildPin(object.type,object.name,object.description,object.latlng,0.65,d.owner,object.v||false);group7.addLayer(pin7.getMarker());group6.addLayer(pin6.getMarker())}}catch(err){_didIteratorError2=true;_iteratorError2=err}finally{try{if(!_iteratorNormalCompletion2&&_iterator2.return){_iterator2.return()}}finally{if(_didIteratorError2){throw _iteratorError2}}}}})};for(var _iterator=datas[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){_loop()}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}map.addLayer(group6);// map events
map.on('contextmenu',function(ev){window.prompt('Copy to clipboard: Ctrl+C, Enter',ev.latlng.lat.toFixed(3)+','+ev.latlng.lng.toFixed(3))});map.on('zoomstart',function(){map.removeLayer(group6);map.removeLayer(group7)});map.on('zoomend',function(){var zoom=map.getZoom();if(zoom==6){map.addLayer(group6)}else{map.addLayer(group7)}});
